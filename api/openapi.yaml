openapi: "3.0.3"
info:
  title: CRM Platform API
  version: 0.1.0
  description: Enterprise CRM platform with metadata-driven objects and granular security.

servers:
  - url: http://localhost:8080
    description: Local development

tags:
  - name: system
    description: System health and diagnostics
  - name: auth
    description: Authentication and authorization
  - name: metadata-objects
    description: Object definition management
  - name: metadata-fields
    description: Field definition management
  - name: soql
    description: SOQL query execution
  - name: dml
    description: DML statement execution
  - name: templates
    description: Application template management

paths:
  /healthz:
    get:
      summary: Health check
      operationId: healthCheck
      tags:
        - system
      responses:
        "200":
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: ok

  /api/v1/auth/login:
    post:
      summary: Authenticate user
      operationId: login
      tags:
        - auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequest"
      responses:
        "200":
          description: Authentication successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenPairResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /api/v1/auth/refresh:
    post:
      summary: Refresh access token
      operationId: refreshToken
      tags:
        - auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshRequest"
      responses:
        "200":
          description: Token refreshed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenPairResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /api/v1/auth/logout:
    post:
      summary: Logout (revoke refresh token)
      operationId: logout
      tags:
        - auth
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                refresh_token:
                  type: string
      responses:
        "204":
          description: Logged out
        "401":
          $ref: "#/components/responses/Unauthorized"

  /api/v1/auth/me:
    get:
      summary: Get current user info
      operationId: getMe
      tags:
        - auth
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Current user
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserInfoResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /api/v1/auth/forgot-password:
    post:
      summary: Request password reset
      operationId: forgotPassword
      tags:
        - auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ForgotPasswordRequest"
      responses:
        "200":
          description: If the email exists, a reset link has been sent
        "400":
          $ref: "#/components/responses/BadRequest"

  /api/v1/auth/reset-password:
    post:
      summary: Reset password with token
      operationId: resetPassword
      tags:
        - auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResetPasswordRequest"
      responses:
        "200":
          description: Password has been reset
        "400":
          $ref: "#/components/responses/BadRequest"

  /api/v1/admin/security/users/{userId}/password:
    parameters:
      - name: userId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    put:
      summary: Set user password (admin)
      operationId: setUserPassword
      tags:
        - auth
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SetPasswordRequest"
      responses:
        "200":
          description: Password updated
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/admin/metadata/objects:
    post:
      summary: Create object definition
      operationId: createObject
      tags:
        - metadata-objects
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateObjectRequest"
      responses:
        "201":
          description: Object created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ObjectResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "409":
          $ref: "#/components/responses/Conflict"
        "500":
          $ref: "#/components/responses/InternalError"

    get:
      summary: List object definitions
      operationId: listObjects
      tags:
        - metadata-objects
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: per_page
          in: query
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
        - name: object_type
          in: query
          schema:
            type: string
            enum: [standard, custom]
      responses:
        "200":
          description: List of objects
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ObjectListResponse"
        "500":
          $ref: "#/components/responses/InternalError"

  /api/v1/admin/metadata/objects/{objectId}:
    parameters:
      - $ref: "#/components/parameters/ObjectId"

    get:
      summary: Get object definition
      operationId: getObject
      tags:
        - metadata-objects
      responses:
        "200":
          description: Object definition
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ObjectResponse"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalError"

    put:
      summary: Update object definition
      operationId: updateObject
      tags:
        - metadata-objects
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateObjectRequest"
      responses:
        "200":
          description: Object updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ObjectResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalError"

    delete:
      summary: Delete object definition
      operationId: deleteObject
      tags:
        - metadata-objects
      responses:
        "204":
          description: Object deleted
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalError"

  /api/v1/admin/metadata/objects/{objectId}/fields:
    parameters:
      - $ref: "#/components/parameters/ObjectId"

    post:
      summary: Create field definition
      operationId: createField
      tags:
        - metadata-fields
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateFieldRequest"
      responses:
        "201":
          description: Field created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FieldResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"
        "500":
          $ref: "#/components/responses/InternalError"

    get:
      summary: List field definitions for object
      operationId: listFields
      tags:
        - metadata-fields
      responses:
        "200":
          description: List of fields
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FieldListResponse"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalError"

  /api/v1/admin/metadata/objects/{objectId}/fields/{fieldId}:
    parameters:
      - $ref: "#/components/parameters/ObjectId"
      - $ref: "#/components/parameters/FieldId"

    get:
      summary: Get field definition
      operationId: getField
      tags:
        - metadata-fields
      responses:
        "200":
          description: Field definition
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FieldResponse"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalError"

    put:
      summary: Update field definition
      operationId: updateField
      tags:
        - metadata-fields
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateFieldRequest"
      responses:
        "200":
          description: Field updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FieldResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalError"

    delete:
      summary: Delete field definition
      operationId: deleteField
      tags:
        - metadata-fields
      responses:
        "204":
          description: Field deleted
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalError"

  /api/v1/query:
    get:
      summary: Execute SOQL query (GET)
      operationId: executeQueryGet
      tags:
        - soql
      parameters:
        - name: q
          in: query
          required: true
          description: SOQL query string
          schema:
            type: string
          example: "SELECT Id, Name FROM Account WHERE Name = 'Acme'"
      responses:
        "200":
          description: Query result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SOQLResult"
        "400":
          $ref: "#/components/responses/BadRequest"
        "403":
          $ref: "#/components/responses/Forbidden"
        "500":
          $ref: "#/components/responses/InternalError"

    post:
      summary: Execute SOQL query (POST)
      operationId: executeQueryPost
      tags:
        - soql
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SOQLRequest"
      responses:
        "200":
          description: Query result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SOQLResult"
        "400":
          $ref: "#/components/responses/BadRequest"
        "403":
          $ref: "#/components/responses/Forbidden"
        "500":
          $ref: "#/components/responses/InternalError"

  /api/v1/data:
    post:
      summary: Execute DML statement
      operationId: executeDML
      tags:
        - dml
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DMLRequest"
      responses:
        "200":
          description: DML result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DMLResult"
        "400":
          $ref: "#/components/responses/BadRequest"
        "403":
          $ref: "#/components/responses/Forbidden"
        "500":
          $ref: "#/components/responses/InternalError"

  /api/v1/admin/templates:
    get:
      summary: List available application templates
      operationId: listTemplates
      tags:
        - templates
      security:
        - BearerAuth: []
      responses:
        "200":
          description: List of templates
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TemplateListResponse"

  /api/v1/admin/templates/{templateId}/apply:
    parameters:
      - name: templateId
        in: path
        required: true
        schema:
          type: string
    post:
      summary: Apply an application template
      operationId: applyTemplate
      tags:
        - templates
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Template applied successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TemplateApplyResponse"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"
        "500":
          $ref: "#/components/responses/InternalError"

  /api/v1/describe:
    get:
      summary: List accessible objects for navigation
      operationId: listDescribeObjects
      tags:
        - describe
      security:
        - BearerAuth: []
      responses:
        "200":
          description: List of queryable objects
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/ObjectNavItem"

  /api/v1/describe/{objectName}:
    parameters:
      - name: objectName
        in: path
        required: true
        schema:
          type: string
    get:
      summary: Describe object with fields
      operationId: describeObject
      tags:
        - describe
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Object description with fields
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/ObjectDescribe"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/records/{objectName}:
    parameters:
      - name: objectName
        in: path
        required: true
        schema:
          type: string
    get:
      summary: List records for an object
      operationId: listRecords
      tags:
        - records
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PerPage"
      responses:
        "200":
          description: Paginated list of records
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      additionalProperties: true
                  pagination:
                    $ref: "#/components/schemas/PaginationMeta"
        "404":
          $ref: "#/components/responses/NotFound"
    post:
      summary: Create a record
      operationId: createRecord
      tags:
        - records
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: true
      responses:
        "201":
          description: Record created
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
        "400":
          $ref: "#/components/responses/BadRequest"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/records/{objectName}/{recordId}:
    parameters:
      - name: objectName
        in: path
        required: true
        schema:
          type: string
      - name: recordId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    get:
      summary: Get a record by ID
      operationId: getRecord
      tags:
        - records
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Record data
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    additionalProperties: true
        "404":
          $ref: "#/components/responses/NotFound"
    put:
      summary: Update a record
      operationId: updateRecord
      tags:
        - records
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: true
      responses:
        "200":
          description: Record updated
        "400":
          $ref: "#/components/responses/BadRequest"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
    delete:
      summary: Delete a record
      operationId: deleteRecord
      tags:
        - records
      security:
        - BearerAuth: []
      responses:
        "204":
          description: Record deleted
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  # NOTE: Security endpoints (roles, permission-sets, profiles, users, groups,
  # sharing-rules) are registered manually via SecurityHandler.RegisterRoutes.
  # They are not included in OpenAPI codegen to avoid ServerInterface bloat.

components:
  parameters:
    ObjectId:
      name: objectId
      in: path
      required: true
      schema:
        type: string
        format: uuid

    FieldId:
      name: fieldId
      in: path
      required: true
      schema:
        type: string
        format: uuid

    Page:
      name: page
      in: query
      schema:
        type: integer
        default: 1
        minimum: 1

    PerPage:
      name: per_page
      in: query
      schema:
        type: integer
        default: 20
        minimum: 1
        maximum: 100

  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    LoginRequest:
      type: object
      required:
        - username
        - password
      properties:
        username:
          type: string
        password:
          type: string

    RefreshRequest:
      type: object
      required:
        - refresh_token
      properties:
        refresh_token:
          type: string

    ForgotPasswordRequest:
      type: object
      required:
        - email
      properties:
        email:
          type: string
          format: email

    ResetPasswordRequest:
      type: object
      required:
        - token
        - password
      properties:
        token:
          type: string
        password:
          type: string
          minLength: 8
          maxLength: 128

    SetPasswordRequest:
      type: object
      required:
        - password
      properties:
        password:
          type: string
          minLength: 8
          maxLength: 128

    TokenPair:
      type: object
      properties:
        access_token:
          type: string
        refresh_token:
          type: string

    TokenPairResponse:
      type: object
      properties:
        data:
          $ref: "#/components/schemas/TokenPair"

    UserInfo:
      type: object
      properties:
        id:
          type: string
          format: uuid
        username:
          type: string
        email:
          type: string
        first_name:
          type: string
        last_name:
          type: string
        profile_id:
          type: string
          format: uuid
        role_id:
          type: string
          format: uuid
        is_active:
          type: boolean

    UserInfoResponse:
      type: object
      properties:
        data:
          $ref: "#/components/schemas/UserInfo"

    CreateObjectRequest:
      type: object
      required:
        - api_name
        - label
        - plural_label
        - object_type
      properties:
        api_name:
          type: string
          minLength: 2
          maxLength: 100
          example: Invoice__c
        label:
          type: string
          minLength: 1
          example: Invoice
        plural_label:
          type: string
          minLength: 1
          example: Invoices
        description:
          type: string
          default: ""
        object_type:
          type: string
          enum: [standard, custom]
        is_visible_in_setup:
          type: boolean
          default: true
        is_custom_fields_allowed:
          type: boolean
          default: true
        is_deleteable_object:
          type: boolean
          default: true
        is_createable:
          type: boolean
          default: true
        is_updateable:
          type: boolean
          default: true
        is_deleteable:
          type: boolean
          default: true
        is_queryable:
          type: boolean
          default: true
        is_searchable:
          type: boolean
          default: false
        has_activities:
          type: boolean
          default: false
        has_notes:
          type: boolean
          default: false
        has_history_tracking:
          type: boolean
          default: false
        has_sharing_rules:
          type: boolean
          default: false
        visibility:
          type: string
          enum: [private, public_read, public_read_write, controlled_by_parent]
          default: private

    UpdateObjectRequest:
      type: object
      required:
        - label
        - plural_label
      properties:
        label:
          type: string
          minLength: 1
        plural_label:
          type: string
          minLength: 1
        description:
          type: string
        is_visible_in_setup:
          type: boolean
        is_custom_fields_allowed:
          type: boolean
        is_deleteable_object:
          type: boolean
        is_createable:
          type: boolean
        is_updateable:
          type: boolean
        is_deleteable:
          type: boolean
        is_queryable:
          type: boolean
        is_searchable:
          type: boolean
        has_activities:
          type: boolean
        has_notes:
          type: boolean
        has_history_tracking:
          type: boolean
        has_sharing_rules:
          type: boolean
        visibility:
          type: string
          enum: [private, public_read, public_read_write, controlled_by_parent]

    ObjectDefinition:
      type: object
      properties:
        id:
          type: string
          format: uuid
        api_name:
          type: string
        label:
          type: string
        plural_label:
          type: string
        description:
          type: string
        object_type:
          type: string
          enum: [standard, custom]
        is_platform_managed:
          type: boolean
        is_visible_in_setup:
          type: boolean
        is_custom_fields_allowed:
          type: boolean
        is_deleteable_object:
          type: boolean
        is_createable:
          type: boolean
        is_updateable:
          type: boolean
        is_deleteable:
          type: boolean
        is_queryable:
          type: boolean
        is_searchable:
          type: boolean
        has_activities:
          type: boolean
        has_notes:
          type: boolean
        has_history_tracking:
          type: boolean
        has_sharing_rules:
          type: boolean
        visibility:
          type: string
          enum: [private, public_read, public_read_write, controlled_by_parent]
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    ObjectResponse:
      type: object
      properties:
        data:
          $ref: "#/components/schemas/ObjectDefinition"

    ObjectListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/ObjectDefinition"
        pagination:
          $ref: "#/components/schemas/PaginationMeta"

    CreateFieldRequest:
      type: object
      required:
        - api_name
        - label
        - field_type
      properties:
        api_name:
          type: string
          minLength: 2
          maxLength: 100
        label:
          type: string
          minLength: 1
        description:
          type: string
          default: ""
        help_text:
          type: string
          default: ""
        field_type:
          type: string
          enum: [text, number, boolean, datetime, picklist, reference]
        field_subtype:
          type: string
          enum: [plain, area, rich, email, phone, url, integer, decimal, currency, percent, auto_number, date, datetime, time, single, multi, association, composition, polymorphic]
        referenced_object_id:
          type: string
          format: uuid
        is_required:
          type: boolean
          default: false
        is_unique:
          type: boolean
          default: false
        config:
          $ref: "#/components/schemas/FieldConfig"
        is_custom:
          type: boolean
          default: false
        sort_order:
          type: integer
          default: 0

    UpdateFieldRequest:
      type: object
      required:
        - label
      properties:
        label:
          type: string
          minLength: 1
        description:
          type: string
        help_text:
          type: string
        is_required:
          type: boolean
        is_unique:
          type: boolean
        config:
          $ref: "#/components/schemas/FieldConfig"
        sort_order:
          type: integer

    FieldConfig:
      type: object
      properties:
        max_length:
          type: integer
        precision:
          type: integer
        scale:
          type: integer
        format:
          type: string
        start_value:
          type: integer
        relationship_name:
          type: string
        on_delete:
          type: string
          enum: [set_null, cascade, restrict]
        is_reparentable:
          type: boolean
        default_value:
          type: string

    FieldDefinitionSchema:
      type: object
      properties:
        id:
          type: string
          format: uuid
        object_id:
          type: string
          format: uuid
        api_name:
          type: string
        label:
          type: string
        description:
          type: string
        help_text:
          type: string
        field_type:
          type: string
        field_subtype:
          type: string
        referenced_object_id:
          type: string
          format: uuid
        is_required:
          type: boolean
        is_unique:
          type: boolean
        config:
          $ref: "#/components/schemas/FieldConfig"
        is_system_field:
          type: boolean
        is_custom:
          type: boolean
        is_platform_managed:
          type: boolean
        sort_order:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    FieldResponse:
      type: object
      properties:
        data:
          $ref: "#/components/schemas/FieldDefinitionSchema"

    FieldListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/FieldDefinitionSchema"

    SOQLRequest:
      type: object
      required:
        - query
      properties:
        query:
          type: string
          description: SOQL query string
          example: "SELECT Id, Name FROM Account LIMIT 10"
        pageSize:
          type: integer
          minimum: 1
          maximum: 2000
          default: 100
          description: Maximum number of records per page

    SOQLResult:
      type: object
      properties:
        totalSize:
          type: integer
          description: Total number of records returned
        done:
          type: boolean
          description: Whether all records have been returned
        records:
          type: array
          items:
            type: object
            additionalProperties: true
          description: Query result records
        nextRecordsUrl:
          type: string
          description: Cursor for fetching the next page (empty if done)

    DMLRequest:
      type: object
      required:
        - statement
      properties:
        statement:
          type: string
          description: DML statement string
          example: "INSERT INTO Account (Name, Industry) VALUES ('Acme', 'Technology')"

    DMLResult:
      type: object
      properties:
        rowsAffected:
          type: integer
          format: int64
          description: Number of rows affected
        insertedIds:
          type: array
          items:
            type: string
          description: IDs of inserted records
        updatedIds:
          type: array
          items:
            type: string
          description: IDs of updated records
        deletedIds:
          type: array
          items:
            type: string
          description: IDs of deleted records

    TemplateInfo:
      type: object
      properties:
        id:
          type: string
        label:
          type: string
        description:
          type: string
        status:
          type: string
          enum: [available, applied, blocked]
        objects:
          type: integer
        fields:
          type: integer

    TemplateListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/TemplateInfo"

    TemplateApplyResponse:
      type: object
      properties:
        data:
          type: object
          properties:
            template_id:
              type: string
            message:
              type: string

    ObjectNavItem:
      type: object
      properties:
        api_name:
          type: string
        label:
          type: string
        plural_label:
          type: string
        is_createable:
          type: boolean
        is_queryable:
          type: boolean

    ObjectDescribe:
      type: object
      properties:
        api_name:
          type: string
        label:
          type: string
        plural_label:
          type: string
        is_createable:
          type: boolean
        is_updateable:
          type: boolean
        is_deleteable:
          type: boolean
        fields:
          type: array
          items:
            $ref: "#/components/schemas/FieldDescribe"

    FieldDescribe:
      type: object
      properties:
        api_name:
          type: string
        label:
          type: string
        field_type:
          type: string
        field_subtype:
          type: string
        is_required:
          type: boolean
        is_read_only:
          type: boolean
        is_system_field:
          type: boolean
        sort_order:
          type: integer
        config:
          type: object
          properties:
            max_length:
              type: integer
            precision:
              type: integer
            scale:
              type: integer
            default_value:
              type: string
            values:
              type: array
              items:
                type: object
                properties:
                  id:
                    type: string
                  value:
                    type: string
                  label:
                    type: string
                  sort_order:
                    type: integer
                  is_default:
                    type: boolean
                  is_active:
                    type: boolean

    PaginationMeta:
      type: object
      properties:
        page:
          type: integer
        per_page:
          type: integer
        total:
          type: integer
          format: int64
        total_pages:
          type: integer
          format: int64

    ErrorBody:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
        message:
          type: string

    ErrorResponse:
      type: object
      required:
        - error
      properties:
        error:
          $ref: "#/components/schemas/ErrorBody"

  responses:
    BadRequest:
      description: Validation error
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    Unauthorized:
      description: Authentication required or invalid
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    Forbidden:
      description: Action not permitted
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    Conflict:
      description: Duplicate or conflict
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    InternalError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
